<div class="row">
    <div class="col-xs-12">
        <h3 class="header smaller lighter blue">Transacciones</h3>

        <button class="btn-woBox button-glow" ng-click="crearNuevoIngreso()">
            <i class="ace-icon fa fa-plus align-top bigger-125"></i>
            Nuevo Registro
        </button>
        <a class="btn btn-success" href="#/bancos">
            <i class="ace-icon fa glyphicon-euro align-top bigger-125"></i>
            Cuentas
        </a>
        <div>
            <!-- <div class="col-md-7"> -->
            <form name="formularioFiltroPolifuncionalidad" novalidate ng-submit="buscarfiltrado()">
                <fieldset>
                    <br>
                    <legend>Filtro Transacciones</legend>
                    <table class="table table-striped table-bordered table-hover">
                        <tbody>
                            <tr>
                                <td>

                                </td>
                                <td>
                                    <label>Desde</label>
                                </td>
                                <td>
                                    <label>Hasta</label>
                                </td>

                                <td>

                                </td>
                            </tr>
                            <tr>
                                <td>
                                    PERIODO
                                </td>
                                <td>
                                    <div ng-class="{'has-error-date':fechasIncorrectaInic}">
                                        <input ng-update-hidden type="text" class="date-picker form-control"
                                            ng-change="validarFechaI(filtro.desde,filtro.hasta)"
                                            data-date-format="dd/mm/yyyy" ng-model="filtro.desde">
                                        <!-- <select required id="mesPolifuncionalidad" name="mesPolifuncionalidad" ng-options="mes as mes.nombre for mes in mesesFiltro track by mes.id"
                                            ng-model="filtro.mes">
                                            <option value="" selected>TODOS</option>
                                        </select> -->
                                    </div>
                                </td>
                                <td>
                                    <div ng-class="{'has-error-date':fechasIncorrectaFin}">
                                        <input ng-update-hidden type="text" class="date-picker form-control"
                                            ng-change="validarFechaF(filtro.desde,filtro.hasta)"
                                            data-date-format="dd/mm/yyyy" ng-model="filtro.hasta">
                                        <!-- <select required id="anioPolifuncionalidad" name="anioPolifuncionalidad" ng-options="anio as anio.nombre for anio in anios track by anio.id"
                                            ng-model="filtro.anio">
                                            <option value="" selected>TODOS</option>
                                        </select> -->
                                    </div>
                                </td>
                                <td>
                                    <div class=" container-fluid">
                                        <button type="submit" class="btn btn-app btn-primary btn-xs"
                                            ng-disabled=" fechasIncorrectaInic || fechasIncorrectaFin ">
                                            <i class="ace-icon fa fa-search align-top bigger-100"></i>
                                            Filtrar
                                        </button>
                                        <button type="submit" class="btn btn-app btn-danger btn-xs">
                                            <i class="ace-icon fa fa-print align-top bigger-100"></i>
                                            PDF
                                        </button>
                                        <button type="submit" class="btn btn-app btn-success btn-xs">
                                            <i class="ace-icon fa fa-print align-top bigger-100"></i>
                                            Excel
                                        </button>
                                    </div>
                                </td>
                                <td rowspan="5" colspan="2">
                                    <div id="sidebar" style='width:100%' class="sidebar">
                                        <script type="text/javascript">
                                            try { ace.settings.check('sidebar', 'fixed') } catch (e) { }
                                            var options = [];
                                        </script>
                                        <div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
                                            <div class="container-fluid row">
                                                <div class="center">
                                                    <b>ESTADO DE CUENTA</b>
                                                </div>
                                                <div class="container-fluid">
                                                    <div class=" col-md-6">
                                                        <div class="row">
                                                            <b>Fondos disponibles</b>
                                                        </div>
                                                        <div class="row">
                                                            <b>Ingresos en tránsito</b>
                                                        </div>
                                                        <div class="row">
                                                            <b>Egresos en tránsito</b>
                                                        </div>
                                                        <div class="row">
                                                            <b>Saldo Final</b>
                                                        </div>
                                                        <!-- <div class="row">
                                                            &nbsp;
                                                        </div> -->
                                                        <div class="row">
                                                            <b>Saldo Pignorado</b>
                                                        </div>
                                                    </div>
                                                    <div class=" col-md-6">
                                                        <div class="row">
                                                            <b
                                                                ng-if="fondosDisponibles >= 0">{{fondosDisponibles | number: 2}}</b>
                                                            <b ng-if="fondosDisponibles < 0"
                                                                class="red">{{fondosDisponibles | number: 2}}</b>
                                                        </div>
                                                        <div class="row">
                                                            <b>{{ingresosEnTransito | number: 2}}</b>
                                                        </div>
                                                        <div class="row">
                                                            <b class="red">{{egresosEnTransito*-1 | number: 2}}</b>
                                                        </div>
                                                        <div class="row">
                                                            <b ng-if="saldoFinal >= 0">{{saldoFinal | number: 2}}</b>
                                                            <b ng-if="saldoFinal < 0"
                                                                class="red">{{saldoFinal | number: 2}}</b>
                                                        </div>
                                                        <!-- <div class="container-fluid row">
                                                            &nbsp;
                                                        </div> -->
                                                        <div class="container-fluid row">
                                                            <b ng-if="saldoPignorado >= 0">
                                                                {{saldoPignorado | number: 2}}</b>
                                                            <b ng-if="saldoPignorado < 0" class="red">
                                                                {{saldoPignorado | number: 2}}</b>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
                                            <i class="ace-icon fa fa-angle-double-up"
                                                data-icon1="ace-icon fa fa-angle-double-up"
                                                data-icon2="ace-icon fa fa-angle-double-down"></i>
                                        </div>
                                        <script type="text/javascript">
                                            try { ace.settings.check('sidebar', 'collapsed') } catch (e) { }
                                        </script>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>

                                </td>
                                <td>
                                    <label>Banco/Cta.</label>
                                </td>
                                <td>
                                    <label>Nombre</label>
                                </td>
                                <td>
                                    <label>Concepto</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    FILTRO
                                </td>
                                <td>
                                    <!-- <select id="centroCostoPolifuncionalidad" name="centroCostoPolifuncionalidad" ng-options="centroCosto as centroCosto.nombre for centroCosto in centrosCostos track by centroCosto.id"
                                            ng-model="filtro.centroCosto">
                                            <option value="" selected>TODOS</option>
                                        </select> -->
                                    <select required id="filtro-bancos" name="filtro-bancos"
                                        ng-options="banco as (banco.nombre +' '+ banco.numero) for banco in bancos track by banco.id"
                                        ng-change="seleccionarCuenta(filtro.cuenta)" ng-model="filtro.cuenta">
                                        <!-- <option value="">TODOS</option> -->
                                    </select>
                                </td>
                                <td>
                                    <input type="text" name="filtro-nombre" id="filtro-nombre" ng-model="filtro.nombre">
                                </td>
                                <td style="max-width: 20%; width: 20%">
                                    <select style="max-width: 180px;width: 180px" id="filtro-concepto"
                                        name="filtro-concepto"
                                        ng-options="concepto.id as concepto.nombre for concepto in conceptosTransaccion.clases track by concepto.id"
                                        ng-model="filtro.concepto">
                                        <option value="" selected>TODOS</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>

                                </td>
                                <td>
                                    <label>Ref./Doc.</label>
                                </td>
                                <td>
                                    <label>Tipo documento</label>
                                </td>
                                <td>
                                    <label>Estado</label>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    <input type="text" ng-model="filtro.ref_doc">
                                    <!-- <select id="filtro-ref-doc" name="filtro-ref-doc" ng-options="ref_doc as ref_doc.nombre for ref_doc in ref_documentos track by ref_doc.id"
                                        ng-model="filtro.ref_doc">
                                        <option value="" selected>TODOS</option>
                                    </select> -->

                                </td>
                                <td>
                                    <select id="filtro-tipo" name="filtro-tipo"
                                        ng-options="tipo_doc.id as tipo_doc.nombre for tipo_doc in tiposDocumentos.clases track by tipo_doc.id"
                                        ng-model="filtro.tipo_doc">
                                        <option value="" selected>TODOS</option>
                                    </select>
                                </td>
                                <td>
                                    <select id="filtro-estado" name="filtro-estado"
                                        ng-options="estado.id as estado.nombre for estado in estadosTransaccion track by estado.id"
                                        ng-model="filtro.estado">
                                        <option value="" selected>TODOS</option>
                                    </select>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </fieldset>
            </form>
        </div>

        <div class="clearfix">
            <div class="pull-right tableTools-container"></div>
        </div>
        <div class="table-header">
            Lista de Transacciones
            <style type="text/css" scoped>
                .dropdown-menu {
                    min-width: 250px !important;
                }
            </style>
            <label class="pull-right">
                <div class="col-xs-10" ng-include src="'/templates/gral/fields-viewer.html'"></div>
            </label>
        </div>
        <div id="tabla-transacciones_wrapper" class="dataTables_wrapper form-inline no-footer widget-body" style="overflow-x:auto;">
            <div class="row" ng-include src="'/templates/gral/paginator-header-2.html'">
            </div>
            <table id="tabla-bancos" class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th class="center">
                            <label class="pos-rel">
                                <input type="checkbox" class="ace" />
                                <span class="lbl"></span>
                            </label>
                        </th>
                        <th class="center" ng-if="fieldViewer.getConfiguration().numero.show">
                            N°
                        </th>
                        <th ng-if="fieldViewer.getConfiguration().fecha.show">Fecha</th>
                        <th>N° Transacción</th>
                        <th ng-if="fieldViewer.getConfiguration().banco.show">Banco</th>
                        <th class="hidden-480" ng-if="fieldViewer.getConfiguration().detalle.show">Detalle</th>
                        <th class="hidden-480" ng-if="fieldViewer.getConfiguration().nombre.show">Nombre</th>
                        <th ng-if="fieldViewer.getConfiguration().concepto.show">Concepto</th>
                        <th ng-if="fieldViewer.getConfiguration().observaciones.show">Observaciones</th>
                        <th ng-if="fieldViewer.getConfiguration().ref_doc.show">Ref./Doc.</th>
                        <th ng-if="fieldViewer.getConfiguration().tipo_doc.show">Documento</th>
                        <th ng-if="fieldViewer.getConfiguration().debe.show">Debe</th>
                        <th ng-if="fieldViewer.getConfiguration().haber.show">Haber</th>
                        <th ng-if="fieldViewer.getConfiguration().saldo.show">Saldo</th>
                        <th ng-if="fieldViewer.getConfiguration().estado.show">Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="center">
                            <label class="pos-rel">
                                <input type="checkbox" class="ace" />
                                <span class="lbl"></span>
                            </label>
                        </td>
                        <td class="center" ng-if="fieldViewer.getConfiguration().numero.show"></td>
                        <td></td>
                        <td ng-if="fieldViewer.getConfiguration().fecha.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().banco.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().detalle.show">Saldo incial</td>
                        <td ng-if="fieldViewer.getConfiguration().nombre.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().concepto.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().observaciones.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().ref_doc.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().tipo_doc.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().debe.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().haber.show"></td>
                        <td ng-if="fieldViewer.getConfiguration().saldo.show">{{saldoAntFechaInicial | number: 2}}</td>
                       <!--  <td ng-if="fieldViewer.getConfiguration().saldo.show">{{saldoInicial | number: 2}}</td> -->
                        <td ng-if="fieldViewer.getConfiguration().estado.show"></td>
                        <td>
                            <a class="orange" href="javascript:void(0)" e-disabled="!aplicacion.puede_ver"
                                ng-click="ver(transaccion)" data-rel="tooltip" tooltip-placement="top"
                                uib-tooltip="Ver">
                                <i class="ace-icon fa fa-file-text bigger-130"></i>
                            </a>
                        </td>
                    </tr>
                    <tr ng-repeat="transaccion in transacciones">
                        <td class="center">
                            <label class="pos-rel">
                                <input type="checkbox" class="ace" />
                                <span class="lbl"></span>
                            </label>
                        </td>
                        <td class="center" ng-if="fieldViewer.getConfiguration().numero.show">
                            {{$index+1}}
                        </td>
                        <td ng-if="fieldViewer.getConfiguration().fecha.show">{{transaccion.fecha | date: 'dd/MM/yyyy'}}</td>
                        <td ng-if="fieldViewer.getConfiguration().fecha.show">{{transaccion.correlativo}}</td>
                        <td ng-if="fieldViewer.getConfiguration().banco.show">{{transaccion.cuenta.nombre}}</td>
                        <td ng-if="fieldViewer.getConfiguration().detalle.show">{{transaccion.detalle}}</td>
                        <td ng-if="fieldViewer.getConfiguration().nombre.show">{{(transaccion.cliente !== null && transaccion.cliente !== undefined)? transaccion.cliente.razon_social:
                            transaccion.proveedor.razon_social}}
                        </td>
                        <td ng-if="fieldViewer.getConfiguration().concepto.show">{{transaccion.concepto.nombre}}</td>
                        <td ng-if="fieldViewer.getConfiguration().observaciones.show">{{transaccion.observaciones}}</td>
                        <td ng-if="fieldViewer.getConfiguration().ref_doc.show">{{transaccion.ref_doc}}</td>
                        <td ng-if="fieldViewer.getConfiguration().tipo_doc.show">{{transaccion.tipo_documento.nombre}}
                        </td>
                        <!--Showing haber in debe column-->
                        <td ng-if="fieldViewer.getConfiguration().debe.show">{{transaccion.haber | number: 2}}</td>
                        <td ng-if="fieldViewer.getConfiguration().haber.show">{{transaccion.debe | number: 2}}</td>
                        <td ng-if="fieldViewer.getConfiguration().saldo.show">
                            <div class="red" ng-if="transaccion.saldo < 0">
                                {{transaccion.saldo | number: 2}}
                            </div>
                            <div ng-if="transaccion.saldo >= 0">
                                {{transaccion.saldo | number: 2}}
                            </div>
                        </td>
                        <td ng-if="fieldViewer.getConfiguration().estado.show">{{transaccion.estado.nombre}}</td>
                        <td>
                            <div class="hidden-sm hidden-xs action-buttons">
                                <a class="green" e-disabled="!aplicacion.puede_ver" href="javascript:void(0)"
                                    ng-click="obtenerComprobanteTransaccion(transaccion)" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Imprimir Comprobante">
                                    <i class="ace-icon fa fa-print bigger-130"></i>
                                </a>
                                <a ng-if="transaccion.haber && !transaccion.debe" class="orange"
                                    e-disabled="!aplicacion.puede_ver" href="javascript:void(0)"
                                    ng-click="abrirModalVerIngreso(transaccion)" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Ver">
                                    <i class="ace-icon fa fa-file-text bigger-130"></i>
                                </a>
                                <a ng-if="transaccion.debe && !transaccion.haber" class="orange"
                                    e-disabled="!aplicacion.puede_ver" href="javascript:void(0)"
                                    ng-click="abrirModalVerEgreso(transaccion)" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Ver">
                                    <i class="ace-icon fa fa-file-text bigger-130"></i>
                                </a>
                                <a ng-if="transaccion.saldo && !transaccion.debe && !transaccion.haber" class="orange"
                                    e-disabled="!aplicacion.puede_ver" href="javascript:void(0)"
                                    ng-click="abrirModalVerIngreso(transaccion)" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Ver">
                                    <i class="ace-icon fa fa-file-text bigger-130"></i>
                                </a>
                                <a href="javascript:void(0)" class="orange"
                                    ng-if="transaccion.estado.nombre === 'EN TRÁNSITO' && !transaccion.cerrada"
                                    ng-click="editarTransaccion(transaccion)" data-rel="tooltip" tooltip-placement="top"
                                    uib-tooltip="Editar"> &nbsp;
                                    <i class="ace-icon fa fa-pencil-square-o bigger-130"></i> &nbsp;
                                </a>
                                <a ng-if="transaccion.seguimientos[0].black && transaccion.seguimiento" href="javascript:void(0)"
                                    ng-click="seguimiento(transaccion)" data-rel="tooltip" tooltip-placement="top"
                                    uib-tooltip="Seguimiento">
                                    <img src="/img/hand-black.png" alt="" height="15" width="20">
                                </a>

                                <a ng-if="transaccion.seguimientos[0].yellow" href="javascript:void(0)"
                                    ng-click="seguimiento(transaccion)" data-rel="tooltip" tooltip-placement="top"
                                    uib-tooltip="Seguimiento">
                                    <img src="/img/hand-yellow.png" alt="" height="15" width="20">
                                </a>

                                <a ng-if="transaccion.seguimientos[0].green" href="javascript:void(0)"
                                    ng-click="seguimiento(transaccion)" data-rel="tooltip" tooltip-placement="top"
                                    uib-tooltip="Seguimiento">
                                    <img src="/img/hand-green.png" alt="" height="15" width="20">
                                </a>

                                <a href="javascript:void(0)" class="bg-silver img-circle"
                                    ng-if="transaccion.estado.nombre === 'EN TRÁNSITO' && transaccion.seguimiento"
                                    ng-click="estadoConfirmado(transaccion)" data-rel="tooltip" tooltip-placement="top"
                                    uib-tooltip="Confirmar"> &nbsp;
                                    <i class="ace-icon fa fa-thumbs-up white"></i> &nbsp;
                                </a>
                                <a href="javascript:void(0)" class="bg-green img-circle"
                                    ng-if="transaccion.estado.nombre === 'CONFIRMADO'&& transaccion.seguimiento" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Confirmado">
                                    &nbsp;
                                    <i class="ace-icon fa fa-thumbs-up white"></i> &nbsp;
                                </a>

                                <a href="javascript:void(0)" class="green" ng-if="!transaccion.cerrada && transaccion.seguimiento"
                                    ng-click="abrirModalRevision(transaccion)" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Cerrar">
                                    <i class="ace-icon fa fa-unlock bigger-130"></i>
                                </a>
                                <a class="blue" href="javascript:void(0)" ng-if="!transaccion.cerrada && transaccion.concepto.nombre === 'PAGO'" data-rel="tooltip" tooltip-placement="top" uib-tooltip="Comp-Cheque"
                                    ng-click="abrirNuevoAdjuntarPDF(transaccion)">
									<i class="ace-icon fa fa-cloud-upload bigger-130"></i>
								</a>
                                <a class="blue" href="javascript:void(0)" ng-if="transaccion.cerrada && transaccion.doc_respaldo" target="_blank"
                                    ng-href='{{transaccion.doc_respaldo}}'  data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Imprimir Respaldo">
                                    <i class="ace-icon fa fa-file-text bigger-130"></i>
                                </a>
                                <a class="blue" href="javascript:void(0)" ng-if="transaccion.cerrada && !transaccion.doc_respaldo && !transaccion.concepto.nombre === 'PAGO'" target="_blank"
                                    ng-href='{{transaccion.doc_respaldo}}'  data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Respaldo NO ADJUNTADO">
                                    <i class="ace-icon fa fa-file-text bigger-130"></i>
                                </a>
                                <a href="javascript:void(0)" class="green" ng-if="!transaccion.cerrada && !transaccion.seguimiento"
                                    ng-click="estadoConfirmadoCerrar(transaccion)" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Cerrar/Correo">
                                    <i class="ace-icon fa fa-unlock bigger-130"></i>
                                </a>
                                <a href="javascript:void(0)" class="red" ng-if="transaccion.cerrada" data-rel="tooltip"
                                    tooltip-placement="top" uib-tooltip="Cerrado">
                                    <i class="ace-icon fa fa-lock bigger-130"></i>
                                </a>
                                <a class="blue" href="javascript:void(0)" ng-if=" !transaccion.id_comprobante" data-rel="tooltip" tooltip-placement="top" uib-tooltip="Integrar"
                                    ng-click="crearNuevoComprobanteTransaccionLista(transaccion)"><!--  //showSelecccionPago(transaccion) && -->
									<i class="ace-icon fa fa-sign-out bigger-130"></i>
								</a>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="row" ng-include src="'/templates/gral/paginator.html'" ng-if="transacciones.length > 0">
        </div>
    </div>
</div>

<div id="modal-wizard-seguimiento" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form ng-submit="guardarSeguimiento(transaccion)">
                <div class="modal-header bg-blue">
                    <h2 class="center">SEGUIMIENTO</h2>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Proveedor</b>
                                    <label>
                                        <input name="switch-field-1" tabindex="-1"
                                            ng-model="transaccion.seguimientos[0].proveedor"
                                            class="ace ace-switch ace-switch-4 ng-pristine ng-untouched ng-valid ng-empty"
                                            type="checkbox">
                                        <span class="lbl check-descuento"></span>
                                    </label>
                                </div>
                                <div class="col-md-6">
                                    <!-- <label>
                                        <input type="checkbox" class="ace" ng-model="seguimiento.proveedor" />
                                        <span class="lbl"></span>
                                    </label> -->
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div ng-if="!transaccion.seguimientos[0].proveedor" class="row">
                                <div class="col-md-6">
                                    <b>Entregado por:</b>
                                    <select style="max-width: 180px;width: 180px" name="seguimiento-entregado"
                                        ng-model="transaccion.seguimientos[0].entregado_por"
                                        ng-options="empleado as empleado.persona.nombre_completo for empleado in empleados track by empleado.id">
                                        <option disabled value="">Seleccion personal</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <b>Devuelto a:</b>
                                    <select ng-disabled="transaccion.seguimientos[0].id_entregado == null"
                                        style="max-width: 180px;width: 180px" name="seguimiento-devuelto"
                                        ng-model="transaccion.seguimientos[0].devuelto_a"
                                        ng-options="empleado as empleado.persona.nombre_completo for empleado in empleados track by empleado.id">
                                        <option disabled value="">Seleccion personal</option>
                                    </select>
                                </div>
                            </div>
                            <div ng-if="transaccion.seguimientos[0].proveedor" class="row">
                                <div class="col-md-6">
                                    <b>Entregado por:</b>
                                    <select name="seguimiento-entregado"
                                        ng-model="transaccion.seguimientos[0].entregado_por"
                                        ng-options="empleado as empleado.persona.nombre_completo for empleado in empleados track by empleado.id">
                                        <option disabled value="">Seleccion personal</option>
                                    </select>
                                </div>
                                <div class="col-md-6">

                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div ng-if="!transaccion.seguimientos[0].proveedor" class="row">
                                <div class="col-md-6">
                                    <b>Fecha entrega &nbsp; &nbsp; &nbsp; &nbsp; </b>
                                    <br>
                                    <b ng-if="transaccion.seguimientos[0].fecha_entrega"
                                        class="green">{{transaccion.seguimientos[0].fecha_entrega | date: "dd/MM/yyyy"}}</b>
                                    <b ng-if="!transaccion.seguimientos[0].fecha_entrega"
                                        class="red">{{fecha_hoy | date: "dd/MM/yyyy"}}</b>

                                </div>
                                <div class="col-md-6">
                                    <b>Fecha devolución &nbsp; &nbsp; &nbsp; &nbsp; </b>
                                    <br>
                                    <b ng-if="transaccion.seguimientos[0].fecha_devolucion"
                                        class="green">{{transaccion.seguimientos[0].fecha_devolucion | date: "dd/MM/yyyy"}}</b>
                                    <b ng-if="!transaccion.seguimientos[0].fecha_devolucion"
                                        class="red">{{fecha_hoy | date: "dd/MM/yyyy"}}</b>

                                </div>
                            </div>
                            <div ng-if="transaccion.seguimientos[0].proveedor" class="row">
                                <div class="col-md-6">
                                    <b>Fecha entrega &nbsp; &nbsp; &nbsp; &nbsp; </b>
                                    <br>
                                    <b ng-if="transaccion.seguimientos[0].fecha_entrega"
                                        class="green">{{transaccion.seguimientos[0].fecha_entrega | date: "dd/MM/yyyy"}}</b>
                                    <b ng-if="!transaccion.seguimientos[0].fecha_entrega"
                                        class="red">{{fecha_hoy | date: "dd/MM/yyyy"}}</b>

                                </div>
                                <div class="col-md-6">

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer wizard-actions">
                    <button type="submit" class="btn btn-primary">GUARDAR</button>
                    <button type="button" ng-click="cerrarModalSeguimiento()"
                        class="btn btn-danger pull-left">SALIR</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="modal-wizard-revision" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form ng-submit="guardarRevision()">
                <div class="modal-header bg-blue">
                    <h2 class="center">REVISADO</h2>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Observaciones &nbsp; &nbsp; &nbsp; &nbsp; </b>
                                    <input autocomplete="off" type="text" ng-model="transaccion.observaciones">
                                </div>
                                <div class="col-md-6">
                                    <!-- <input class="date-picker" type="text" ng-update-hidden data-date-format="dd/MM/yyyy" name="fecha" ng-model="segumiento.fecha"> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer wizard-actions">
                    <button type="submit" class="btn btn-success">GUARDAR</button>
                    <button type="button" ng-click="cerrarModalRevision()"
                        class="btn btn-danger pull-left">SALIR</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="modal-wizard-nuevo-ingreso" class="modal wizard-posicion">
    <div class="modal-content">
        <form ng-submit="guardarIngreso(ingresoNuevo)">
            <div class="modal-header bg-blue">
                <h2 class="center">REGISTRAR TRANSACCIÓN</h2>
            </div>
            <div class="modal-body">
                <div class="container-fluid">

                    <div class="row">
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>FECHA</b>
                            <div hidden>
                                <input type="text" class="date-picker form-control" name="escondido">
                            </div>
                            <div>
                                <input ng-update-hidden type="text" name="fecha" autocomplete="off" class="date-picker-pedido form-control"  required ng-model="ingresoNuevo.fecha">
                            </div>
                        </div>

                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>CONCEPTO</b> &nbsp;&nbsp;
                            <a class="green" href="javascript:void(0)"  tabindex="-1" ng-click="abrirDialogConceptoEdicion(conceptosTransaccion)"><i class="ace-icon fa fa-pencil bigger-130"></i></a>
                            <!--  <span class="input-group-addon glyphicon glyphicon-pencil point-edit green" aria-hidden="true" ng-click="abrirDialogConceptoEdicion(conceptosTransaccion)"></span> -->
                            <select id="conceptoTransaccion" required ng-model="ingresoNuevo.concepto" class="form-control" ng-options="concepto.id as concepto.nombre for concepto in conceptosTransaccion.clases track by concepto.id" ng-change="verificarConcepto(ingresoNuevo)"  ng-disabled="ingresoNuevo.ventas.length > 0">
                                <option disabled value="">Seleccione concepto</option>
                            </select>
                        </div>

                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>TIPO</b>&nbsp;&nbsp;
                            <a class="green" href="javascript:void(0)" aria-hidden="true" tabindex="-1" ng-click="abrirDialogConceptoEdicion(tiposDocumentos)"><i class="ace-icon fa fa-pencil bigger-130"></i></a>
                            <!-- <span class="input-group-addon glyphicon glyphicon-pencil point-edit green" aria-hidden="true" ng-click="abrirDialogConceptoEdicion(tiposDocumentos)"></span> -->
                            <select id="tipo_docTransaccion" required ng-model="ingresoNuevo.tipo_doc"
                                class="form-control"
                                ng-options="tipo as tipo.nombre for tipo in tiposDocumentos.clases track by tipo.id"
                                ng-change="asignarTipoDoc(ingresoNuevo)">
                                <option value="">Seleccione tipo de documento</option>
                            </select>
                        </div>
                    
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>BANCO</b>
                            <select id="bancoTransaccion" required ng-model="ingresoNuevo.cuenta"
                                class="form-control"
                                ng-options="banco.id as (banco.nombre + ' ' + banco.numero) for banco in bancos track by banco.id">
                                <option value="">Seleccione un banco</option>
                            </select>
                        </div>

                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>REF./DOC.</b>
                            <input id="ref_docTransaccion" type="text" name="ref_doc" class="form-control" ng-model="ingresoNuevo.ref_doc" ng-change="asignarRefDoc(ingresoNuevo)">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6  col-lg-4">
                            <b>OBSERVACION</b>
                            <input id="observacionTransaccion" type="text" name="observacion" class="form-control" ng-model="ingresoNuevo.observacion" ng-change="asignarObservacion(ingresoNuevo)">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>DETALLE</b>
                            <input type="text" disabled class="form-control" ng-model="ingresoNuevo.detalle">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-if="showSelecccionCobro(ingresoNuevo)">
                            <b style="vertical-align: super;">RAZON SOCIAL CLIENTE</b>&nbsp;&nbsp;
                            <!-- <span class="lbl " style="vertical-align: super;">Ver Todos</span> -->
                            <span class="lbl" style="vertical-align: super;">Ver Todos</span>
                            <input name="ll " tabindex="-1" class="ace ace-switch ace-switch-4 ng-valid ng-dirty ng-valid-parse ng-not-empty ng-touched" type="checkbox" ng-model="listTodos">
                            <span class="lbl check-descuento"></span>
                            <div class="col-md-12" ng-if="listTodos != true">
                                <input class="form-control" id='transacRazonSocial'
                                autocomplete="off" 
                                ng-keypress="interceptarTecla($event,'razon_social',true)"
                                type="text"
                                ng-model="ingresoNuevo.detalleSeleccionado" 
                                placeholder="Ej: rosa*2*34 - Razon Social*Nº Factura*Nº Proforma"
                                uib-typeahead="proforma as (proforma.razon_social+' - Factura Nº '+proforma.factura+' - Proforma Nº '+proforma.correlativo+' - Saldo = '+proforma.saldo) for proforma in buscarTransaccion($viewValue)"
                                typeahead-wait-ms="1000" 
                                typeahead-template-url="templates/autocompletar.html"
                                typeahead-show-hint="false" 
                                typeahead-min-length="2" 
                                typeahead-select-on-exact="true"
                                typeahead-on-select="establecerTansaccion($item, $model, $label, $event)">  
                                
                                <script type="text/ng-template" id="templates/autocompletar.html">
                                    <a>
                                        <i style="color: green" class="icon fa fa-money bigger-150"></i>
                                        <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>
                                        <span class="text-warning orange bolder"> BS</span>
                                    </a>
                                </script>
                            </div>
                            <div class="col-md-12" ng-if="listTodos == true">
                                <ui-select class="col-xs-12 col-sm-12 col-md-12" style="padding-left: 15px; padding-right: 0px;"
                                    ng-model="ingresoNuevo.detalleSeleccionado" theme="select2" title="Seleccionar...">
                                    <ui-select-match placeholder="seleccionar..." style="padding-left: 15px;">
                                        <span style="color:black">{{$select.selected.razon_social}}</span>
                                        <span>{{'Factura N° ' + $select.selected.factura}}</span>
                                        <span>{{'Proforma N° ' + $select.selected.correlativo}}</span>
                                        <span>{{'SALDO = ' + $select.selected.saldo }}</span>
                                    </ui-select-match>
                                    <ui-select-choices
                                        repeat="detalle in proformasPorCobrar | filter: $select.search track by detalle.id">
                                        <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>
                                        <span> {{detalle.razon_social}} </span>
                                        <span>{{'Factura N° ' + detalle.factura}}</span>
                                        <span>{{'Proforma N° ' + detalle.correlativo}}</span>
                                        <span>{{'SALDO = ' + detalle.saldo }}</span>
                                    </ui-select-choices>
                                </ui-select>
                            </div>
                           <!--  <div class="col-md-1"><button type="button" ng-click="agregardetalleTransaccion(ingresoNuevo)" class="btn btn-success pull-right">AGREGAR</button></div> -->
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-1 align-center" ng-if="showSelecccionCobro(ingresoNuevo)">
                            <br>
                            <button type="button" ng-click="agregardetalleTransaccion(ingresoNuevo)" class="btn btn-success">AGREGAR</button>
                        </div>
                        
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-if="showSelecccionPago(ingresoNuevo)">
                            <b style="vertical-align: super;">RAZON SOCIAL PROVEEDOR</b>&nbsp;&nbsp;
                            <div class="col-md-12">
                                <input class="form-control" id='transacPagos'
                                autocomplete="off" 
                                ng-keypress="interceptarTecla($event,'razon_social',true)"
                                type="text"
                                ng-model="ingresoNuevo.detalleSeleccionadoPago" 
                                placeholder="Ej: rosa*2 - Razon Social*Nº Progamación"
                                uib-typeahead="pagoProgramados as (pagoProgramados.razon_social+' - Nº Progra '+pagoProgramados.correlatProgramPago+' - Saldo = '+pagoProgramados.saldo ) for pagoProgramados in buscarTransaccionPagos($viewValue)"
                                typeahead-wait-ms="1000" 
                                typeahead-template-url="templates/autocompletar.html"
                                typeahead-show-hint="false" 
                                typeahead-min-length="2" 
                                typeahead-select-on-exact="true"
                                typeahead-on-select="establecerTansaccion($item, $model, $label, $event)">  
                                
                                <script type="text/ng-template" id="templates/autocompletar.html">
                                    <a>
                                        <i style="color: green" class="icon fa fa-money bigger-150"></i>
                                        <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>
                                        <span class="text-warning orange bolder"> BS</span>
                                    </a>
                                </script>
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-1 align-center" ng-if="showSelecccionPago(ingresoNuevo)">
                            <br>
                            <button type="button" ng-click="agregardetalleTransaccionPago(ingresoNuevo)" class="btn btn-success">AGREGAR</button>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-if="showSelecccionSaldoInic(ingresoNuevo)">
                            <b>MONTO</b>
                            <input required id="montoTransaccion" type="number" step="0.001" class="form-control" name="monto" ng-model="ingresoNuevo.monto" ng-change="asignarHaber(ingresoNuevo)">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-3 align-center" ng-if="(showSelecccionCobro(ingresoNuevo) || showSelecccionPago(ingresoNuevo)) && showSelecccionSeguimiento(ingresoNuevo)">
                            <span class="lbl" style="vertical-align: super;">SEGUIMIENTO</span><br>
                            <input name="seguimiento" tabindex="-1" class="ace ace-switch ace-switch-4 ng-valid ng-dirty ng-valid-parse ng-not-empty ng-touched" type="checkbox" ng-model="ingresoNuevo.seguimiento">
                            <span class="lbl check-descuento"></span>
                        </div>
                    </div><br>


                <div class="widget-body" style="overflow-x:auto;" ng-if="showSelecccionCobro(ingresoNuevo) || showSelecccionPago(ingresoNuevo)">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>
                                    <label>Nro.</label>
                                </th>
                                <th>
                                    <label>Razón social</label>
                                </th>
                                <th>
                                    <label>Factura</label>
                                </th>
                                <th>
                                    <label>fecha</label>
                                </th>
                                <th ng-if="showSelecccionCobro(ingresoNuevo)">
                                    <label>N° Proforma</label>
                                </th>
                                <th ng-if="showSelecccionPago(ingresoNuevo)">
                                    <label>N° Programac </label>
                                </th>
                                <th>
                                    <label><b>Importe </b></label>
                                </th>
                                <th>
                                    <label>Saldo Ant</label>
                                </th>
                                <th>
                                    <label>Saldo Act</label>
                                </th>
                                <th ng-if="showSelecccionCobro(ingresoNuevo)">
                                    <label>Monto a cobrar</label>
                                </th>
                                <th ng-if="showSelecccionPago(ingresoNuevo)">
                                    <label>Monto a Pagar</label>
                                </th>
                                <th>
                                    <label>Acciones</label>
                                </th>
                            </tr>
                        </thead>
                        <tbody ng-if="showSelecccionCobro(ingresoNuevo)">
                            <tr ng-if="!d.eliminado" ng-repeat="d in ingresoNuevo.ventas">
                                <td>
                                    {{$index+1}}
                                </td>
                                <td>
                                    {{d.cliente.razon_social}}
                                </td>
                                <td>
                                    {{d.factura}}
                                </td>
                                <td>
                                    {{d.factura_proforma | date:"dd/MM/yyyy"}}
                                </td>
                                <td>
                                    {{d.correlativo}}
                                </td>
                                <td align ='right'>
                                    {{d.total | number:2}}
                                </td>
                                <td align ='right'>
                                    {{d.saldo_ant | number:4}}
                                </td>
                                <td align ='right'>
                                    {{d.saldo | number:2}}
                                </td>
                                <td>
                                    <input type="number" step="0.0001" ng-model='d.porCobrar' ng-change="calcularImporteTransaccion(ingresoNuevo,d)">
                                    <div ng-show=" d.porCobrar > d.saldo_ant || d.porCobrar <= 0 " class="">
                                        <span class="invalid-message">Debe insertar Monto y no puede ser mayor al Saldo Ant</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="col-sm-12">
                                        <a ng-if="pedido.ver!=true"
                                            ng-click="eliminarDetalleTransaccion(d, ingresoNuevo)"
                                            class="red" data-rel="tooltip" tooltip-placement="top"
                                            uib-tooltip="Eliminar">
                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot ng-if="showSelecccionCobro(ingresoNuevo)">
                            <tr>
                                <td colspan="8">
                                    <strong>Total General</strong>
                                </td>
                                <td><strong>{{ingresoNuevo.haber | number:4}}</strong></td>
                                <td colspan="3"></td>
                            </tr>
                        </tfoot>
                        <tbody ng-if="showSelecccionPago(ingresoNuevo)">
                            <tr ng-if="!p.eliminado" ng-repeat="p in ingresoNuevo.pagosProgramad">
                                <td>
                                    {{$index+1}}
                                </td>
                                <td>
                                    {{p.razon_social}}
                                </td>
                                <td>
                                    {{p.factura}}
                                </td>
                                <td>
                                    {{p.fecha | date:"dd/MM/yyyy"}}
                                </td>
                                <td >
                                    {{p.correlatProgramPago}}
                                </td>
                                <td align ='right'>
                                    {{p.total}}
                                </td>
                                <td align ='right'>
                                    {{p.saldo}}
                                </td>
                                <td align ='right'>
                                    {{p.saldoAct | number:2}}
                                </td>
                                <td>
                                    <input type="number" step="0.0001" ng-model='p.porPagar' ng-change="calcularImporteTransaccionPago(ingresoNuevo,p)">
                                    <div ng-show=" p.porPagar > p.saldo || p.porPagar <= 0 " class="">
                                        <span class="invalid-message">Debe insertar Monto y no puede ser mayor al Saldo Ant</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="col-sm-12">
                                        <a ng-if="pedido.ver!=true"
                                            ng-click="eliminarDetalleTransaccionPago(p, ingresoNuevo)"
                                            class="red" data-rel="tooltip" tooltip-placement="top"
                                            uib-tooltip="Eliminar">
                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot ng-if="showSelecccionPago(ingresoNuevo)">
                            <tr>
                                <td colspan="8">
                                    <strong>Total General</strong>
                                </td>
                                <td><strong>{{ingresoNuevo.debe | number:4}}</strong></td>
                                <td colspan="3"></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
            <div class="modal-footer wizard-actions">
                <button type="submit" class="btn-woBox button-glow" ng-disabled="detalleInvalid || ingresoNuevo.ventas.length == 0 " ng-if="showSelecccionCobro(ingresoNuevo)">GUARDAR COBRO</button>
                <button type="submit" class="btn-woBox button-glow" ng-disabled="detalleInvalidP || ingresoNuevo.pagosProgramad.length == 0 " ng-if="showSelecccionPago(ingresoNuevo)">GUARDAR PAGO</button>
                <button type="submit" class="btn-woBox button-glow" ng-disabled="detalleInvalid" ng-if="!showSelecccionCobro(ingresoNuevo) && !showSelecccionPago(ingresoNuevo)" >GUARDAR SALDO INICIAL</button>
                <button type="button" ng-click="cerrarModalNuevoIngreso(ingresoNuevo)"
                    class="btn btn-danger pull-left">SALIR</button>
            </div>
        </form>
    </div>
</div>
<div id="dialog-conceptos" class="modal">
    <div class="modal-header bg-primary">
        <h4 class='smaller text-white text-uppercase'>
            <i class='icono-prerequisito'></i>
            <label> &nbsp;{{tipo_edicion.nombre}}:</label>
        </h4>
    </div>
    <div class="row">
        <div class="col-sm-5">
            <div class="form-group">
                <label for="ciudad">Nombre</label>
                <input ng-model="clase.nombre" type="text" capitalize style="text-transform:uppercase;"
                    class="form-control" name="ciudad" placeholder="Cochabamba">
            </div>
        </div>
        <div class="col-sm-5">
            <div class="form-group">
                <label for="ciudad">Nombre Corto</label>
                <input ng-model="clase.nombre_corto" type="text" capitalize style="text-transform:uppercase;"
                    class="form-control" name="ciudad" placeholder="CB">
            </div>
        </div>
        <div class="col-sm-2">
            <br>
            <div class="form-group">
                <button type="button" class="btn btn-success" ng-click="agregarConceptoEdicion(clase)">
                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                </button>
            </div>
        </div>
    </div>
    <div class="table-responsive">
        <div class="table-fixed-header">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th class="th-fix">Nombre</th>
                        <th class="th-fix">Nombre Corto</th>
                        <th class="th-fix">Habilitar</th>
                        <th class="th-fix">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="clase in tipo_edicion.clases">
                        <th scope="row">{{clase.nombre}}</th>
                        <td>{{clase.nombre_corto}}</td>
                        <td>
                            <!-- <label>
                                  <input ng-model="clase.habilitado" name="switch-field-1" class="ace ace-switch ace-switch-5" type="checkbox">
                                  <span class="lbl check-espaniol"></span>
                              </label> -->
                            <label class="pos-rel">
                                <input name="switch-field-1" type="checkbox" class="ace" ng-model="clase.habilitado" />
                                <span class="lbl"></span>
                            </label>
                        </td>
                        <td>
                            <a class="green" href="javascript:void(0)" ng-click="modificarConceptoEdicion(clase)">
                                <i class="ace-icon fa fa-pencil bigger-130"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <div class="row">
        <div class="modal-footer wizard-actions">
            <button class="btn btn-primary btn-sm" ng-click="guardarConceptoEdicion(tipo_edicion)">
                <i class="glyphicon glyphicon-floppy-disk"></i>Guardar
            </button>
            <button class="btn btn-danger btn-sm" ng-click="cerrarDialogConceptoEdicion()">
                <i class="ace-icon fa fa-times"></i>Cancelar
            </button>
        </div>
    </div>
</div>
<div id="modal-wizard-editar-transaccion" class="modal wizard-posicion">
    <div class="modal-content">
        <form ng-submit="guardarEdicionTransaccionn(transaccion)">
            <div class="modal-header bg-blue">
                <h2 class="center">EDICIÓN DE TRANSACCIÓN   N°: {{transaccion.correlativo}}</h2>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <div class="row">
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>FECHA</b>
                            <div hidden>
                                <input type="text" class="date-picker form-control" name="escondido" autofocus>
                            </div>
                            <div>
                                <input ng-update-hidden type="text" name="fecha" autocomplete="off" class="date-picker-pedido form-control" required ng-model="transaccion.fecha_texto" ng-disabled='transaccion.id_comprobante' >
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>CONCEPTO</b>
                            <a class="green" href="javascript:void(0)" aria-hidden="true" tabindex="-1" ng-click="abrirDialogConceptoEdicion(conceptosTransaccion)"><i class="ace-icon fa fa-pencil bigger-130"></i></a>
                            <select disabled id="conceptoTransaccion" required ng-model="transaccion.concepto" class="form-control" ng-options="concepto as concepto.nombre for concepto in conceptosTransaccion.clases track by concepto.id" ng-change="verificarConcepto(transaccion)" ng-disabled="transaccion.detallesTransaccion.length > 0 ">
                                <option  value="">Seleccione concepto</option>
                            </select>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>TIPO</b> &nbsp; &nbsp;
                            <a class="green" href="javascript:void(0)" aria-hidden="true" tabindex="-1" ng-click="abrirDialogConceptoEdicion(tiposDocumentos)"><i class="ace-icon fa fa-pencil bigger-130"></i></a>
                            <select required id="tipo_docTransaccion" ng-model="transaccion.tipo_documento" class="form-control" ng-options="tipo as tipo.nombre for tipo in tiposDocumentos.clases track by tipo.id" ng-change="asignarTipoDoc(transaccion)" ng-disabled='transaccion.id_comprobante'>
                                <option disabled value="">Seleccione tipo de documento</option>
                            </select>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>BANCO</b>
                            <select id="bancoTransaccion" required ng-model="transaccion.cuenta" class="form-control" ng-options="banco as (banco.nombre + ' ' + banco.numero) for banco in bancos track by banco.id" ng-disabled='transaccion.id_comprobante'>
                                <option disabled value="">Seleccione un banco</option>
                            </select>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>REF./DOC.</b>
                            <input id="ref_docTransaccion" type="text" name="ref_doc" class="form-control" ng-model="transaccion.ref_doc">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>OBSERVACIÓN</b>
                            <input id="observacionTransaccion" type="text" name="observaciones" class="form-control" ng-model="transaccion.observaciones" ng-change="asignarObservacion(transaccion)" ng-disabled='transaccion.id_comprobante'>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4">
                            <b>DETALLE</b>
                            <input disabled  type="text" class="form-control" ng-model="transaccion.detalle">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-if="showSelecccionCobro(transaccion)">
                            <b>RAZON SOCIAL CLIENTE</b>
                            <div class="col-md-12 input-group">
                                <ui-select class="col-md-12" style="padding-left: 15px; padding-right: 0px;"
                                    ng-model="transaccion.detalleSeleccionadoEd" theme="select2" title="Seleccionar...">
                                    <ui-select-match placeholder="seleccionar..." style="padding-left: 15px;">
                                        <span style="color:black">{{$select.selected.razon_social}}</span>
                                        <span>{{'Factura N° ' + $select.selected.factura}}</span>
                                        <span>{{'Proforma N° ' + $select.selected.correlativo}}</span>
                                        <span>{{'SALDO = ' + $select.selected.saldo }}</span>
                                    </ui-select-match>
                                    <ui-select-choices
                                        repeat="detalle in proformasPorCobrarEdic | filter: $select.search track by detalle.id">
                                        <span> {{detalle.razon_social}} </span>
                                        <span>{{'Factura N° ' + detalle.factura}}</span>
                                        <span>{{'Proforma N° ' + detalle.correlativo}}</span>
                                        <span>{{'SALDO = ' + detalle.saldo }}</span>
                                    </ui-select-choices>
                                </ui-select>
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-1" ng-if="showSelecccionCobro(transaccion)">
                            <div class="input-group">&nbsp;<br>
                                <button type="button" ng-click="agregardetalleTransaccionEd(transaccion)" class="btn btn-success">AGREGAR</button>
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-if="showSelecccionPago(transaccion) && !transaccion.id_comprobante">
                            <b style="vertical-align: super;">RAZON SOCIAL PROVEEDOR</b>&nbsp;&nbsp;
                            <div class="col-md-12">
                                <input class="form-control" id='transacPagos'
                                autocomplete="off" 
                                ng-keypress="interceptarTecla($event,'razon_social',true)"
                                type="text"
                                ng-model="transaccion.detalleSeleccionadoEdPago" 
                                placeholder="Ej: rosa*2 - Razon Social*Nº Progamación"
                                uib-typeahead="pagoProgramados as (pagoProgramados.razon_social+' - Nº Progra '+pagoProgramados.correlatProgramPago+' - Saldo = '+pagoProgramados.saldo ) for pagoProgramados in buscarTransaccionPagos($viewValue)"
                                typeahead-wait-ms="1000" 
                                typeahead-template-url="templates/autocompletar.html"
                                typeahead-show-hint="false" 
                                typeahead-min-length="2" 
                                typeahead-select-on-exact="true"
                                typeahead-on-select="establecerTansaccion($item, $model, $label, $event)">  
                                
                                <script type="text/ng-template" id="templates/autocompletar.html">
                                    <a>
                                        <i style="color: green" class="icon fa fa-money bigger-150"></i>
                                        <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>
                                        <span class="text-warning orange bolder"> BS</span>
                                    </a>
                                </script>
                            </div>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-1 align-center" ng-if="showSelecccionPago(transaccion) && !transaccion.id_comprobante">
                            <br>
                            <button type="button" ng-click="agregardetalleTransaccionEdPago(transaccion)" class="btn btn-success">AGREGAR</button>
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-6 col-lg-4" ng-if="showSelecccionSaldoInic(transaccion)">
                            <b>MONTO</b>
                            <input required id="montoTransaccion" type="number" step="0.001" class="form-control" name="monto" ng-model="transaccion.monto" ng-change="asignarHaber(transaccion)">
                        </div>
                        <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-3 align-center" ng-if="(showSelecccionCobro(transaccion) || showSelecccionPago(transaccion)) && showSelecccionSeguimiento(transaccion)">
                            <span class="lbl" style="vertical-align: super;">SEGUIMIENTO</span><br>
                            <input name="seguimiento" tabindex="-1" class="ace ace-switch ace-switch-4 ng-valid ng-dirty ng-valid-parse ng-not-empty ng-touched" type="checkbox" ng-model="transaccion.seguimiento">
                            <span class="lbl check-descuento"></span>
                        </div>
                    </div> <br><br>

                <div class="widget-body" style="overflow-x:auto;" ng-if="showSelecccionCobro(transaccion) || showSelecccionPago(transaccion)">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>
                                    <label><b>NRO.</b></label>
                                </th>
                                <th>
                                    <label><b>RAZÓN SOCIAL</b></label>
                                </th>
                                <th>
                                    <label><b>FACTURA</b></label>
                                </th>
                                <th>    
                                    <label><b>FECHA</b></label>
                                </th>
                                <th ng-if="showSelecccionCobro(transaccion)">
                                    <label><b>N° PROFORMA</b></label>
                                </th>
                                <th ng-if="showSelecccionPago(transaccion)">
                                    <label><b>N° PROGRAMC</b></label>
                                </th>
                                <th>
                                    <label><b>IMPORTE </b></label>
                                </th>
                                <th>
                                    <label><b>SALDO ANT</b></label>
                                </th>
                                <th>
                                    <label><b>SALDO ACT</b></label>
                                </th>
                                <th ng-if="showSelecccionCobro(transaccion)">
                                    <label><b>MONTO A COBRAR</b></label>
                                </th>
                                <th ng-if="showSelecccionPago(transaccion)">
                                    <label><b>MONTO A PAGAR</b></label>
                                </th>
                                <th>
                                    <label><b>ACCIONES</b></label>
                                </th>
                            </tr>
                        </thead>
                        <tbody ng-if="showSelecccionCobro(transaccion)">
                            <tr ng-repeat="d in transaccion.detallesTransaccion | filter:filtroEliminado track by $index">
                                <td>
                                    {{$index+1}}
                                </td>
                                <td>
                                    {{d.proforma.cliente.razon_social}}
                                </td>
                                <td>
                                    {{d.proforma.factura}}
                                </td>
                                <td>
                                    {{d.proforma.fecha_proforma | date:"dd/MM/yyyy"}}
                                </td>
                                <td>
                                    {{d.proforma.correlativo}}
                                </td>
                                <td align ='right'>
                                    {{d.proforma.totalImporteBs | number:2}}
                                </td>
                                <td align ='right'>
                                  <!--   {{d.proforma.saldo + d.montoAnterior | number:4}} -->
                                    {{((d.proforma.totalImporteBs) - (d.proforma.aCuentaAnterior)) + d.montoAnterior | number:4}}
                                </td>
                                <td align ='right'>
                                  <!-- {{d.proforma.saldo | number:2}}  -->
                                   {{(d.proforma.totalImporteBs) - (d.proforma.a_cuenta) | number:2}}
                                </td>
                                <td>
                                    <input class="form-control" type="number" step="0.0001" ng-model='d.monto' ng-change="calcularSaldoEd(transaccion, d)">
                                   <div ng-show="((d.proforma.totalImporteBs) - (d.proforma.a_cuenta)) <0 || d.monto <= 0 " class="">
                                        <span class="invalid-message">Debe insertar Monto, Saldo no puede quedar negativo</span>
                                    </div>
                                </td>
                                <td>
                                    <div class=" center col-sm-12">
                                        <a e-disabled="!aplicacion.puede_eliminar" class="red"
                                            ng-click="confirmarEliminarDetalleTransEdicion(d, transaccion, $index)"
                                            data-rel="tooltip" tooltip-placement="top"
                                            uib-tooltip="Eliminar">
                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot ng-if="showSelecccionCobro(transaccion)">
                            <tr>
                                <td colspan="8">
                                    <strong>Total General</strong>
                                </td>
                                <td><strong>{{transaccion.totalGRL | number:4}}</strong></td>
                                <td></td>
                            </tr>
                        </tfoot>
                        <tbody ng-if="showSelecccionPago(transaccion)">
                            <tr ng-if="!p.eliminado" ng-class="{ 'filas-nuevas' : !p.id }" ng-repeat="p in transaccion.detallesTransaccion">
                                <td>
                                    {{$index+1}}
                                </td>
                                <td>
                                    {{p.compra.proveedor.razon_social}}
                                </td>
                                <td>
                                    {{p.compra.factura}}
                                </td>
                                <td>
                                    {{p.compra.fecha | date:"dd/MM/yyyy"}}
                                </td>
                                <td >
                                    {{p.compra.DetalleCompraProgramacionPago.CompraProgramacionPago.correlativo}}
                                </td>
                                <td align ='right'>
                                    {{p.compra.total}}
                                </td>
                                <td align ='right'>
                                    <!-- {{p.compra.saldo | number:2}} -->
                                    {{((p.compra.total) - (p.compra.aCuentaAnterior)) + p.montoAnterior | number:4}}
                                </td>
                                <td align ='right'>
                                   <!--  {{p.compra.saldo | number:2}} -->
                                   {{(p.compra.total) - (p.compra.a_cuenta) | number:2}}
                                </td>
                                <td>
                                    <input type="number" step="0.0001" ng-model='p.monto' ng-change="calcularSaldoEdPago(transaccion,p)" ng-disabled='transaccion.id_comprobante'>
                                    <div ng-show=" p.monto >(((p.compra.total) - (p.compra.aCuentaAnterior)) + (p.montoAnterior)) || p.monto <= 0 " class="">
                                        <span class="invalid-message">Debe insertar Monto y no puede ser mayor al Saldo Ant</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="col-sm-12">
                                        <a ng-if="pedido.ver!=true"
                                            ng-click="confirmarEliminarDetalleTransEdicion(p, transaccion, $index)"
                                            class="red" data-rel="tooltip" tooltip-placement="top"
                                            uib-tooltip="Eliminar">
                                            <i class="ace-icon fa fa-trash-o bigger-130"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tfoot ng-if="showSelecccionPago(transaccion)">
                            <tr>
                                <td colspan="8">
                                    <strong>Total General</strong>
                                </td>
                                <td><strong>{{transaccion.debe | number:4}}</strong></td>
                                <td colspan="3"></td>
                            </tr>
                        </tfoot>                        
                    </table>
                </div>
            </div>
            <div class="modal-footer wizard-actions">
                <button type="submit" class="btn-woBox button-glow" ng-disabled="detalleInvalid || transaccion.detallesTransaccion.length == 0" ng-if="showSelecccionCobro(transaccion)">GUARDAR COBRO</button>
                <button type="submit" class="btn-woBox button-glow" ng-disabled="detalleInvalidEdPag || transaccion.detallesTransaccion.length == 0 " ng-if="showSelecccionPago(transaccion) ">GUARDAR PAGO</button><!-- && transaccion.id_comprobante -->
                <button type="button" ng-click="cerrarEditarTransaccion()"
                    class="btn btn-danger pull-left">SALIR</button>
            </div>
        </form>
    </div>
</div>
<div id="modal-wizard-ver-ingreso" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form ng-submit="cerrarModalVerIngreso()">
                <div class="modal-header bg-blue">
                    <h2 class="center">REGISTRO DE INGRESO</h2>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Fecha</b>
                                </div>
                                <div class="col-md-6">
                                    <div hidden>
                                        <input type="text" class="date-picker" name="escondido" autofocus>
                                    </div>
                                    <div>
                                        <input disabled ng-update-hidden type="text" name="fecha"
                                            data-date-format="dd/MM/yyyy" autocomplete="off" class="date-picker"
                                            ng-model="ingreso.fecha">
                                    </div>
                                    <!-- <div ng-if="ingreso.fecha == undefined">
                                            <input disabled ng-update-hidden type="text" name="fecha" data-date-format="dd/MM/yyyy" autocomplete="off" class="date-picker" ng-model="ingreso.fecha">
                                        </div> -->
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Concepto</b>
                                </div>
                                <div class="col-md-6">
                                    <select disabled ng-model="ingreso.concepto"
                                        ng-options="concepto.id as concepto.nombre for concepto in conceptosTransaccion track by concepto.id">
                                        <option disabled value="">Seleccione concepto</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Banco</b>
                                </div>
                                <div class="col-md-6">
                                    <select name="banco" disabled ng-model="ingreso.cuenta"
                                        ng-options="banco.id as (banco.nombre + ' ' + banco.numero) for banco in bancos track by banco.id">
                                        <option disabled value="">Seleccione un banco</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group" ng-if="showSelecccionCliente(ingreso)">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Nombre</b>
                                </div>
                                <div class="col-md-6">
                                    <select disabled ng-model="ingreso.venta"
                                        ng-options="venta as (venta.cliente.razon_social + ' - Factura N° '+ venta.factura + ' - Saldo ' + venta.saldo) for venta in vencimientosCreditos track by venta.id"
                                        ng-change="establecerConceptoIngreso(ingreso)">
                                        <option disabled value="">Seleccione una credito de cliente</option>
                                    </select>
                                    <!-- <input type="text" name="nombre" ng-model="ingreso.cliente.persona.nombre">
                                            <a href="javascript:void(0)" ng-click="abrirModalVencimientoCreditos()">
                                                <i class="green fa fa-money bigger-200"></i>
                                            </a> -->
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Detalle</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="text" name="detalle" ng-model="ingreso.detalle">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Observación</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="text" name="observacion" ng-model="ingreso.observacion">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Ref./Doc.</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="number" name="ref_doc" ng-model="ingreso.ref_doc">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Tipo</b>
                                </div>
                                <div class="col-md-6">
                                    <select disabled ng-model="ingreso.tipo_doc"
                                        ng-options="tipo.id as tipo.nombre for tipo in tiposDocumentos.clases track by tipo.id">
                                        <option value="">Seleccione tipo de documento</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Monto</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="number" step="0.01" name="monto" ng-model="ingreso.haber">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer wizard-actions">
                    <!-- <button type="submit" class="btn btn-success">INGRESAR</button> -->
                    <button type="button" class="btn-primary img-circle">
                        <b class="bigger-170">></b>
                    </button>
                    <button type="button" ng-click="cerrarModalVerIngreso()"
                        class="btn btn-danger pull-left">SALIR</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="modal-wizard-ver-egreso" class="modal wizard-posicion">
    <div class="modal-dialog">
        <div class="modal-content">
            <form ng-submit="cerrarModalVerEgreso()">
                <div class="modal-header bg-red">
                    <h2 class="center">REGISTRO DE EGRESO</h2>
                </div>
                <div class="modal-body">
                    <div class="container-fluid">
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Fecha</b>
                                </div>
                                <div class="col-md-6">
                                    <div hidden>
                                        <input disabled type="text" class="date-picker" name="escondido" autofocus>
                                    </div>
                                    <div ng-if="egreso.fecha != undefined">
                                        <input disabled autocomplete="off" class="date-picker" ng-model="egreso.fecha"
                                            ng-update-hidden type="text" name="fecha" data-date-format="dd/MM/yyyy">
                                    </div>
                                    <div ng-if="egreso.fecha == undefined">
                                        <input disabled class="date-picker" ng-model="egreso.fecha" ng-update-hidden
                                            type="text" name="fecha" data-date-format="dd/MM/yyyy">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Concepto</b>
                                </div>
                                <div class="col-md-6">
                                    <select disabled ng-model="egreso.concepto"
                                        ng-options="concepto.id as concepto.nombre for concepto in conceptosTransaccion track by concepto.id">
                                        <option disabled value="">Seleccione concepto</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Banco</b>
                                </div>
                                <div class="col-md-6">
                                    <select name="banco" disabled ng-model="egreso.cuenta"
                                        ng-options="banco.id as (banco.nombre + ' ' + banco.numero) for banco in bancos track by banco.id">
                                        <option disabled value="">Seleccione un banco</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Nombre</b>
                                </div>
                                <div class="col-md-6">
                                    <select disabled ng-model="egreso.compra"
                                        ng-options="compra as (compra.proveedor.razon_social + ' - Factura N° '+ compra.factura + ' - Saldo ' + compra.saldo) for compra in vencimientosDeudas track by compra.id"
                                        ng-change="establecerConceptoEgreso(egreso)">
                                        <option disabled value="">Seleccione una deuda a proveedor</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Detalle</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="text" name="detalle" ng-model="egreso.detalle">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Observación</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="text" name="observacion" ng-model="egreso.observacion">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Ref./Doc.</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="number" name="ref_doc" ng-model="egreso.ref_doc">
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Tipo</b>
                                </div>
                                <div class="col-md-6">
                                    <select disabled ng-model="egreso.tipo_doc"
                                        ng-options="tipo.id as tipo.nombre for tipo in tiposDocumentos.clases track by tipo.id">
                                        <option value="">Seleccione tipo de documento</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <b>Monto</b>
                                </div>
                                <div class="col-md-6">
                                    <input disabled type="number" step="0.01" name="monto" ng-model="egreso.debe">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer wizard-actions">
                    <button type="button" ng-click="cerrarModalVerEgreso()"
                        class="btn btn-danger pull-left">SALIR</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div id="tabla-vencimiento-creditos-transaciones" class="modal">
    <div>
        <div class="table-header" align="center">
            Vencimiento Creditos
        </div>

    </div>
    <div class="modal-body">
        <div class="table-fixed-header">
            <table class="table table-striped table-bordered table-hover ">
                <thead fix-head class="table-head-color">
                    <tr>
                        <!-- <th class="center">
                            <label>
                                <input type="checkbox" class="ace" ng-model="venta.seleccionada" />
                                <span class="lbl"></span>
                            </label>
                        </th> -->
                        <th>Nº</th>
                        <th>Razón Social Cliente</th>
                        <th>Factura</th>
                        <th>Fecha Vencimiento</th>
                        <th>Saldo</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="venta in vencimientosCreditos">
                        <!-- <td class="center">
                            <label>
                                <input type="checkbox" class="ace" ng-model="venta.seleccionada" />
                                <span class="lbl"></span>
                            </label>
                        </td> -->
                        <td>{{$index+1}}</td>
                        <td>{{venta.cliente.razon_social}}</td>
                        <td>{{venta.factura}}</td>
                        <td>{{venta.fecha_vencimiento | date:"dd/MM/yyyy"}}
                            <span class="red" ng-if="venta.fecha_anterior"> -
                                ({{venta.fecha_anterior | date:"dd/MM/yyyy" }})</span>
                        </td>
                        <td>{{venta.saldo|number:2}}</td>
                        <td>
                            <a class="red" href="javascript:void(0)" ng-click="seleccionarCredito(venta)">
                                <i class="ace-icon fa fa-calendar bigger-130">Seleccionar</i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="modal-footer">

        <!-- <button class="btn btn-primary" type="button" ng-click="imprimirListaVencimientoCreditos(vencimientosCreditos)">
            <i class="ace-icon fa fa-print align-top bigger-125"></i>Imprimir
        </button> -->

        <button class="btn btn-danger" type="button" ng-click="cerrarModalVencimientoCreditos()">
            <i class="ace-icon fa fa-times red2 align-top bigger-125"></i>Cancelar
        </button>
    </div>
</div>

<!-- MODAL DE INTEGRACION DESDE TRANSACCIONES -->
<div id="modal-wizard-comprobante-transaccion-pago" class="modal wizard-posicion">
    <div class="modal-content">
        <form id="formNuevoComprobante" novalidate name="formNuevoComprobante"
            ng-submit="confirmacionDeGuardarIntegracion(nuevoComprobante)">
            <div class="modal-header">
                <div class="row">
                    <div class="col-sm-9">
                        <button tabindex="-1" type="submit"
                            ng-disabled="nuevoComprobante.$invalid" class="btn btn-primary">
                            <i class="ace-icon fa fa-floppy-o align-top bigger-125"></i>
                            GUARDAR
                        </button>
                        <button tabindex="-1" type="button" class="btn btn-primary btn-danger"
                            ng-click="cerrarDialogComprobanteTransaccion()">
                            <i class="ace-icon fa fa-times red2 align-top bigger-125"></i>
                            CERRAR
                        </button>
                    </div>
                </div>
                <h3 class="header smaller lighter blue">COMPROBANTE &nbsp;
                    <div class="checkbox" ng-if="usuario.crear_comprobante_antiguo">
                        <label class="block">
                            <input name="form-field-checkbox" type="checkbox" ng-disabled="true"
                                ng-model="nuevoComprobante.crearRegistroCompAntiguo" class="ace input-lg">
                            <span class="lbl bigger-120">Crear registros antiguos.</span>
                        </label>
                    </div>                     
                </h3>
                <div class="row" class="col-sm-12">
                    <div class="col-sm-2">
                        <label>TIPO COMPROBANTE:</label>
                        
                        <select autofocus ng-change="ultimaFechaTipoComprobante(nuevoComprobante)"
                            id='id_tipo' required
                            ng-model='nuevoComprobante.tipoComprobante' id="tipoComprobante" name="tipoComprobante"
                            data-placeholder="Click para escoger" class="form-control"
                            ng-options="cuentaTipo as cuentaTipo.nombre for cuentaTipo in tiposComprobantes track by cuentaTipo.id">

                        </select>
                        <span class="red">(*)</span>
                        <div ng-show="formNuevoComprobante.tipoComprobante.$error.required"
                            class="invalid-message help-block"
                            ng-messages="formNuevoComprobante.tipoComprobante.$error"
                            ng-if="formNuevoComprobante.tipoComprobante.$touched || (formNuevoComprobante.$submitted && formNuevoComprobante.tipoComprobante.$invalid)">
                            <div ng-messages-include="/templates/gral/messages.html"></div>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <label>SUCURSAL:</label>
                        <select class="form-control" required
                            data-validate="validate(required)" name="sucursalOrigen" required
                            ng-options="sucursal as sucursal.nombre for sucursal in sucursales track by sucursal.id"
                            ng-model="nuevoComprobante.id_sucursal">

                        </select>
                        <span class="red">(*)</span>
                        <div ng-show="formNuevoComprobante.sucursalOrigen.$error.required"
                            class="invalid-message help-block"
                            ng-messages="formNuevoComprobante.sucursalOrigen.$error"
                            ng-if="formNuevoComprobante.sucursalOrigen.$touched || (formNuevoComprobante.$submitted && formNuevoComprobante.sucursalOrigen.$invalid)">
                            <div ng-messages-include="/templates/gral/messages.html"></div>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <label>FECHA</label>
                        <input ng-change="obtenerCambioMoneda2(nuevoComprobante.fecha);verigicarRegistroAntiguo()" 
                            name="fecha" required ng-update-hidden class="form-control date-picker-pedido"
                            type="text" id="fechaCmp" ng-model="nuevoComprobante.fecha" autocomplete="off"
                            placeholder="Ingrese la fecha" enter />
                        <span class="red">(*)</span>
                        <div ng-show="formNuevoComprobante.fecha.$error.required" class="invalid-message help-block"
                            ng-messages="formNuevoComprobante.fecha.$error" ng-if="formNuevoComprobante.$submitted">
                            <div ng-messages-include="/templates/gral/messages.html"></div>
                        </div>
                    </div>

                </div>
                <h3 class="header smaller lighter blue"></h3>
                <div class="row">
                    <div class="col-sm-10">
                        <h4 class="smaller lighter blue">GLOSA GENERAL</h4>
                    </div>
                    <div class="col-sm-1" align="right">
                        <br>
                        <label style="background-color:lightblue">UFV {{moneda.ufv}}</label>
                    </div>
                    <div class="col-sm-1" align="right">
                        <br>
                        <label style="background-color: bisque">$US T/C {{moneda.dolar}}</label>
                    </div>
                    <!-- <div class="col-sm-2" align="right">
                        <button tabindex="-1" type="button" uib-tooltip="Ejemplo Importación Cambio Moneda"
                            href="/recursos/EJEMPLO-TIPO-CAMBIO-MONEDA.xlsx" class="btn btn-app btn-danger btn-xs">
                            <i class="ace-icon fa fa-cloud-download bigger-140"></i>
                        </button>
                        <div tabindex="-1" class="fileUpload btn btn-app btn-success btn-xs"
                            uib-tooltip="Importar Cambio Moneda">
                            <span class="fileUpload-button ace-icon fa fa-cloud-upload align-top bigger-140"></span>
                            <input tabindex="-1" class="upload" type="file"
                                custom-on-file-change="subirExcelUfvDolar" />
                        </div>
                    </div> -->
                </div>
                <div>
                    <textarea ng-update-hidden 
                     name="gloza" required ng-model="nuevoComprobante.gloza"
                        rows="4" class="form-control" style="min-width: 100%">
                    </textarea>
                    <div ng-show="formNuevoComprobante.gloza.$error.required" class="invalid-message help-block"
                        ng-messages="formNuevoComprobante.gloza.$error"
                        ng-if="formNuevoComprobante.gloza.$valid || (formNuevoComprobante.$submitted && formNuevoComprobante.gloza.$invalid)">
                        <div ng-messages-include="/templates/gral/messages.html"></div>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div class="widget-box">
                    <div class="widget-header row">
                        <div class="col-sm-8">
                            <h4 class="widget-title">TRANSACCIONES</h4>
                        </div>
                        <div class="col-sm-3" align="right">
                            <h4 class="widget-title">BIMONETARIO</h4>
                        </div>
                        <div class="col-sm-1">
                            <input tabindex="-1" name="switch-field-1"
                                ng-change="VerBimonetario(nuevoComprobante.asientosContables)"
                                class="ace ace-switch ace-switch-4 ng-pristine ng-untouched ng-valid ng-empty"
                                type="checkbox" ng-model="opcionBimonetario">
                            <span class="lbl check-descuento"></span>
                        </div>
                    </div>

                    <div class="widget-body">
                        <div class="widget-main">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h4 class="smaller lighter blue">Cuenta.:
                                        <span style="color: mediumblue" ng-bind="cuentaActual.nombre"></span>
                                    </h4>
                                </div>
                                <div class="col-sm-3">
                                    <h4 class="smaller lighter blue"> Debe.:
                                        <span style="color: mediumblue" ng-bind="cuentaActual.debe"></span>
                                    </h4>
                                </div>
                                <div class="col-sm-3">
                                    <h4 class="smaller lighter blue"> Haber.:
                                        <span style="color: mediumblue" ng-bind="cuentaActual.haber"></span>
                                    </h4>
                                </div>
                                <div class="col-sm-2">
                                    <h4 class="smaller lighter blue"> Saldo.:
                                        <span style="color: mediumblue" ng-bind="cuentaActual.saldo"></span>
                                    </h4>
                                </div>
                            </div>
                            <div style="overflow-x:auto;">
                                <table id="tabla-comprobante"
                                    class="table table-striped table-bordered table-hover">
                                    <thead>
                                        <tr>
                                            <th rowspan="2" style="text-align: center">Nº</th>
                                            <th rowspan="2" style="text-align: center">
                                                <div class="col-sm-12">Cuenta
                                                </div>
                                                <div class="col-sm-6"></div>
                                                <div class="col-sm-6"
                                                    ng-hide="nuevoComprobante.asientosContables.length>0">
                                                    <div ng-show="formNuevoComprobante.asientos.$error.detalleAsiento"
                                                        class="invalid-message help-block center"
                                                        ng-messages="formNuevoComprobante.asientos.$error"
                                                        ng-if="formNuevoComprobante.asientos.$valid || (formNuevoComprobante.$submitted && formNuevoComprobante.asientos.$invalid)">
                                                        <div ng-messages-include="/templates/gral/messages.html">
                                                        </div>
                                                    </div>
                                                </div>
                                            </th>
                                            <th colspan="2" style="text-align: center">Bolivianos</th>
                                            <th class="red" style="text-align: center" ng-if="opcionBimonetario"
                                                colspan="2">Dólores</th>
                                        </tr>
                                        <tr>

                                            <th style="text-align: center">Debe</th>
                                            <th style="text-align: center">Haber</th>
                                            <th style="text-align: center" class="red" ng-if="opcionBimonetario">Debe</th>
                                            <th style="text-align: center" class="red" ng-if="opcionBimonetario">Haber</th>
                                        </tr>
                                    </thead>

                                    <tbody ng-if="!asiento.eliminado"
                                        scope="row" ng-repeat="asiento in nuevoComprobante.asientosContables track by $index">
                                        <tr >
                                            <td>
                                                {{$index +1}}
                                            </td>
                                            <td>

                                                <a class="orange" uib-tooltip="Libros Mayores"
                                                    ng-if="asiento.cuenta.id"
                                                    ng-click="abrirModalLibrosMayores(asiento.cuenta)">
                                                    <i class="ace-icon fa fa-file-text-o bigger-130"></i>
                                                </a>
                                                <input enter autocomplete="off" typeahead-append-to-body="true"
                                                    ng-focus="establecerCuentaActual2(asiento, $index)"
                                                    ng-disabled="verComprobante || edicionCierre"
                                                    ng-keypress="interceptarTecla($event,'cantidad',true)"
                                                    id="{{$index}}-As" name="{{$index}}-As" required type="text"
                                                    ng-model="asiento.cuenta" placeholder="Busqueda..."
                                                    uib-typeahead="cuenta as (cuenta.codigo+'-'+cuenta.nombre) for cuenta in buscarCuentas($viewValue,$index)"
                                                    typeahead-wait-ms="300"
                                                    typeahead-template-url="templates/autocompletar.html"
                                                    typeahead-on-select="establecerCuentaActual(asiento,$index)"
                                                    typeahead-min-length="3" class="input-sm">
                                                <span class="invalid-message" ng-show="!asiento.cuenta.id">
                                                    Seleccionar cuenta
                                                </span>
                                                <a name="{{$index}}-CA" id="{{$index}}-CA"
                                                    ng-click="abrirCuentasAxiliares(asiento)"
                                                    uib-tooltip="Cuentas Auxiliares" href="javascript:void(0)"
                                                    ng-if="asiento.cuenta.tipoAuxiliar.id"
                                                    uib-popover-template="PopoverCuentasAxiliares.templateUrl"
                                                    popover-is-open="asiento.isOpen"
                                                    popover-placement="right-bottom" class="blue">
                                                    <i class="fa fa-external-link"></i>
                                                </a>&nbsp
                                                <span class="red">{{asiento.cuentaAux.razon_social}}</span>
                                                <script type="text/ng-template" id="PopoverCuentasAxiliares.html">
                                                    <div class="modal-header">
                                                            <button type="button" class="close" ng-click="asiento.isOpen=false">&times;</button>
                                                            <h4 class="modal-title">Cuentas Auxiliares</h4>
                                                    </div>
                                                    
                                                    <div class="form-group"><br>												
                                                    &nbsp&nbsp&nbsp<span class="input-icon">
                                                            <input type="text" id="form-field-icon-1"  ng-model="filtroAux" class="center">
                                                            <i class="ace-icon fa fa-search blue"></i>
                                                        </span>
                                                    </div>
                                                        <div>
                                                    <select size="8" class="form-control" required ng-change="selecionarCuentaAxiliarProv(asiento)" ng-options="cuenta.razon_social as cuenta.razon_social for cuenta in listaCuentasAuxiliares | filter: filtroAux track by cuenta.id" ng-model="asiento.cuentaAux.razon_social" >
                                                        </select>
                                                        </div>
                                                </script>
                                            </td>
                                            <td
                                                ng-click="establecerCuentaActual2(asiento, $index);inputDebebs(asiento);enfocar($index+'-Bs')">
                                                <label
                                                    ng-hide="indexCuentaAsientoActual === $index">{{asiento.debe_bs|number:2}}</label>
                                                <input ng-hide="indexCuentaAsientoActual != $index" required
                                                    class="input-fix-mousewheel1 form-control input-sm"
                                                    ng-focus="establecerCuentaActual2(asiento, $index);inputDebebs(asiento)"
                                                    disabled
                                                    id="{{$index}}-Bs" type="number" step="0.01"
                                                    ng-model="asiento.debe_bs"
                                                    ng-change="ComvertirDebeEnDolar(asiento,true);cal(nuevoComprobante.asientosContables)"
                                                    enter>
                                            </td>
                                            <td
                                                ng-click="establecerCuentaActual2(asiento, $index);inputDebebs(asiento);enfocar($index+'-Cs')">
                                                <label
                                                    ng-hide="indexCuentaAsientoActual === $index">{{asiento.haber_bs|number:2}}</label>
                                                <input ng-hide="indexCuentaAsientoActual != $index" required
                                                    class="input-fix-mousewheel1 form-control input-sm "
                                                    ng-focus="inputhaberbs2(asiento);establecerCuentaActual2(asiento, $index)"
                                                    disabled
                                                    id="{{$index}}-Cs" type="number" step="0.01"
                                                    ng-model="asiento.haber_bs"
                                                    ng-change="ComvertirHaberEnDolar(asiento,true);cal(nuevoComprobante.asientosContables)"
                                                    enter>
                                            </td>
                                            <td ng-if="opcionBimonetario"
                                                ng-click="establecerCuentaActual2(asiento, $index);inputDebebs(asiento);enfocar($index+'-sus')">
                                                <label
                                                    ng-hide="indexCuentaAsientoActual === $index">{{asiento.debe_sus|number:2}}</label>
                                                <input required class="input-fix-mousewheel1 form-control  input-sm"
                                                    ng-focus="establecerCuentaActual2(asiento, $index);inputDebeSus(asiento)"
                                                    disabled
                                                    id="{{$index}}-sus" type="number" ng-model="asiento.debe_sus"
                                                    step="0.01"
                                                    ng-change="ComvertirDebeEnBolivianos(asiento);cal(nuevoComprobante.asientosContables)"
                                                    enter>
                                            </td>
                                            <td ng-if="opcionBimonetario"
                                                ng-click="establecerCuentaActual2(asiento, $index);inputDebebs(asiento);enfocar($index+'-Hsus')">
                                                <label
                                                    ng-hide="indexCuentaAsientoActual === $index">{{asiento.haber_sus|number:2}}</label>
                                                <input required class="input-fix-mousewheel1 form-control  input-sm"
                                                    step="0.01"
                                                    ng-focus="establecerCuentaActual2(asiento, $index);inputHaberSus(asiento)"
                                                    disabled
                                                    id="{{$index}}-Hsus" type="number" ng-model="asiento.haber_sus"
                                                    ng-change="ComvertirHaberEnBolivianos(asiento);cal(nuevoComprobante.asientosContables)"
                                                    enter>
                                            </td>
                                        </tr>
                                        <tr ng-if="asiento.cuenta.id">
                                            <td colspan="8">
                                                <input 
                                                    class="form-control" ng-model="asiento.glosa"
                                                    placeholder="Agregar glosa individial" enter>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr ng-if="nuevoComprobante.asientosContables.length>0">
                                            <td colspan="2" style="text-align: right">Total</td>
                                            <td style="text-align: center">{{totales.debe_bs}}</td>
                                            <td style="text-align: center">{{totales.haber_bs}}</td>
                                            <td ng-if="opcionBimonetario" style="text-align: center">
                                                {{totales.debe_sus|number:2}}</td>
                                            <td ng-if="opcionBimonetario" style="text-align: center">
                                                {{totales.haber_sus|number:2}}</td>
                                            
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<div id="modal-nuevo-adjuntarPDF" class="modal">
    <div>
        <div class="modal-header ficha">
            <button type="button" class="close" ng-click="cerrarAdjuntarPDF()" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">{{transaccion.proveedor.razon_social}} </h4>
            <h6 class="modal-title" id="myModalLabel">Nº: {{transaccion.correlativo}} </h6>
            <!-- <h5 class="modal-title">{{transaccion.proveedor.razon_social}}</h5> -->
        </div>
        <div class="modal-body">
            <div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12" ><!-- ng-if='!transaccion.doc_respaldo' -->
                        <br> 
                        <center><label for="ap-materno">ADJUNTE EL COMPROBANTE DE RESPALDO</label></center>
                        <input type="file" files-input ng-model="transaccion.doc_respaldo" id="id-adjunto-pdf" accept=".pdf"/>
                        <br> 
                    </div>
                    <center><div class="form-group col-xs-12 col-sm-12 col-md-12 col-lg-12" ng-if='transaccion.doc_respaldo' >
                        <!-- <a class="green" href="javascript:void(0)" ng-click=" " data-rel="tooltip" tooltip-placement="top" uib-tooltip="Modificar PDF" ng-model = 'btn_modificar'>
                            <i class="ace-icon fa fa-pencil bigger-300"></i>
                        </a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
                        <a ng-href='{{transaccion.doc_respaldo}}' target="_blank" data-rel="tooltip" tooltip-placement="top" uib-tooltip="Visualizar PDF" >
                            <i class="ace-icon fa fa-paperclip bigger-300"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="vspace-6-sm"></div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-danger btn-sm pull-left" ng-click="cerrarAdjuntarPDF()">
                <i class="ace-icon fa fa-times"></i>Salir
            </button>
            <button type="submit" class="btn btn-success btn-sm" ng-click="agregarAdjuntoPDF(transaccion)">GUARDAR</button><!-- ng-disabled="!adjuntarDocumento " -->
        </div>
    </div>
</div>
